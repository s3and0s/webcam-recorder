(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},109:function(e,t,n){},121:function(e,t,n){},122:function(e,t,n){},123:function(e,t,n){},124:function(e,t,n){},128:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(17),s=n.n(c),o=(n(67),n(32)),i=n.n(o),l=n(50),u=n(2),d=n(3),m=n(5),p=n(4),f=n(6),g=n(51),v=n.n(g),h=function(e){var t=new URL(window.location.href);return!!t.searchParams.has(e)&&t.searchParams.get(e)},_=n(10),b=n(58),E=n(14),y=n(33),k=n.n(y),S=(n(102),n(7)),C=(n(103),function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(m.a)(this,Object(p.a)(t).call(this))).state={isRecording:!1,recorder:null,videoSrc:null,videoEle:null,startTime:"time"},e.video=r.a.createRef(),e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"getCurrentTime",value:function(){var e=new Date;return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"-"+e.getTime()}},{key:"render",value:function(){return r.a.createElement("div",{className:"vid_card",onClick:this.startRecording},r.a.createElement("video",{className:"cam",controls:!0,autoPlay:!0,playsInline:!0,muted:!0,ref:this.props.videoRef}),r.a.createElement("p",{className:"cam_label"},this.props.name))}}]),t}(r.a.Component)),N=n(34),x=n.n(N);function I(e){var t=Object(a.useState)([]),n=Object(S.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)("recording-status-loading..."),i=Object(S.a)(o,2),l=i[0],u=i[1],d=Object(a.useState)([]),m=Object(S.a)(d,2),p=m[0],f=m[1],g=Object(a.useState)([]),v=Object(S.a)(g,2),b=v[0],E=v[1],y=function(e){return{camera_info:{id:e.deviceId,label:e.label,groupId:e.groupId},ref:r.a.createRef(),recorder:null}},k=function(){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(function(t){var n=[],a=[],r=function(t){var n=t.reduce(function(e,t){return"videoinput"===t.kind?e+1:e},0);return e.updateDetectedNumCams(n),n}(t);console.log("number of cams detected: "+r),t.map(function(e){return"audioinput"===e.kind&&(e.label.toLowerCase().includes("default")||e.label.toLowerCase().includes("communications")||e.label.toLowerCase().includes("built-in")||function(e,t){t.indexOf(e.deviceId)<0&&t.push(e)}(e,a)),"videoinput"===e.kind&&function(e,t){e=y(e),console.log(c);var n=c.filter(function(t){return t.camera_info.id===e.camera_info.id})[0];console.log(n),n?(console.log("found prior device"),e.mic_info=n.mic_info):(console.log("using first cam mic!!!"),e.mic_info=p[0]),t.push(e)}(e,n),null}),f(a),s(n),document.getElementById("startBtn").click(),document.getElementById("startBtn").disabled=!0}).catch(function(e){console.log(e.name+": "+e.message)}):console.log("enumerateDevices() not supported.")};Array.prototype.diff=function(e){return this.filter(function(t){return e.indexOf(t)<0})};var I=function(e,t){if(e){var n=y(e);n.mic_info=t.deviceId,s([n]),document.getElementById("startBtn").disabled=!1,document.getElementById("startBtn").click(),document.getElementById("dummyBtn").disabled=!1,document.getElementById("dummyBtn").click(),_.a.success("Mac FaceTime Camera started",{hideAfter:.3})}},w=function(){try{!function(e){var t=void 0,n=void 0;new Promise(function(){navigator.mediaDevices.enumerateDevices().then(function(e){t=e.filter(function(e){return e.label.toLowerCase().includes("facetime")}),n=e.filter(function(e){return"default"===e.deviceId})}).then(function(){e(t[0],n[0])})})}(I)}catch(e){}navigator.mediaDevices.enumerateDevices().then(function(e){var t=e.filter(function(e){return e.label.toLowerCase().includes("aoni")&&!e.label.toLowerCase().includes("communication")&&!e.label.toLowerCase().includes("default")}),n=!1,a=t.map(function(e){return e.deviceId}),r=a.diff(b);if(0===r.length||2===r.length&&(n=!0),n){var o=function(e,t){var n=t.filter(function(t){return e.indexOf(t.deviceId)>=0&&"videoinput"===t.kind}),a=t.filter(function(t){return e.indexOf(t.deviceId)>=0&&"audioinput"===t.kind});return a.length>1&&console.error("multiple new mics detected"),n.length>1&&console.error("multiple new cams detected"),[a[0].deviceId,n[0]]}(r,t),i=Object(S.a)(o,2),l=i[0],u=i[1];if(u=y(u),!c.filter(function(e){return e.camera_info.id===u.camera_info.id})[0]){u.mic_info=l;var d=c;d.push(u),s(d),_.a.success("New camera: "+u.camera_info.id.substring(0,5)+" added."),document.getElementById("startBtn").disabled=!1,k(),E(a)}}}).then(function(){document.getElementById("dummyBtn").disabled=!1,document.getElementById("dummyBtn").click()})};var B=function(){j(!0)},O=function(){var e="recording-status-loading..."===l?{}:l;c.map(function(t){return t.mic_info||console.error("using default microphone..."),navigator.mediaDevices.getUserMedia({audio:{deviceId:{exact:t.mic_info?t.mic_info:"default"}},video:{frameRate:{exact:30,ideal:30},width:{ideal:1920},height:{ideal:1080},deviceId:t.camera_info.id}}).then(function(n){var a=x()(n,{recorderType:N.MediaStreamRecorder,type:"video",frameRate:30,desiredSampRate:16e3,width:1920,height:1080,numberOfAudioChannels:2,disableLogs:!0});if("recording"!==a.getState()){a.camera=n,t.recorder=a;var r=t.ref;try{r.current.srcObject=n}catch(c){}a.startRecording()}L(e,a,t)}).catch(function(e){console.error(e)}),c})},j=function(t){var n="recording-status-loading..."===l?{}:l;c.map(function(a){var r=a.recorder;return null!==r&&(r.stopRecording(function(){var n=r.getBlob();console.log("%c recorded data","background: #222; color: #bada55",n),!0!==t?e.socket.emit("client: save data",{name:h("name"),sentence_index:h("sentence_index"),camera_id:a.camera_info.id,blob:n}):console.log("dummy received, did not save blob")}),L(n,r,a)),c})},L=function(t,n,a){try{t[a.camera_info.id.substring(0,15)]=n.getState(),u(t),e.updateConnectionStatus(t)}catch(r){_.a.warn("Camera not yet loaded!",{hideAfter:0})}},P=function(){var e="recording-status-loading..."===l?{}:l;c.map(function(t){var n=t.recorder,a=void 0;try{a=n.getState()}catch(r){_.a.warn("Camera not yet loaded!",{hideAfter:0})}if("paused"===a)n.resumeRecording();else if("stopped"===a)try{n.startRecording()}catch(s){_.a.warn("Camera not yet loaded!",{hideAfter:0})}return L(e,n,t),c})};Object(a.useEffect)(function(){e.updateConnectionStatus()},[e.addCamState]),e.socket.on("server: dummy vid, do not save",function(){document.getElementById("dummyBtn").click(),document.getElementById("dummyBtn").disabled=!0}),e.socket.on("server: start cams",function(){document.getElementById("resumeBtn").click(),document.getElementById("resumeBtn").disabled=!0,document.getElementById("stopBtn").disabled=!1}),e.socket.on("server: stop cams",function(){document.getElementById("stopBtn").click(),document.getElementById("stopBtn").disabled=!0,document.getElementById("resumeBtn").disabled=!1});return function(){var e=0,t=c.map(function(t){return r.a.createElement(C,{key:e++,name:"ID: "+t.camera_info.id.substring(0,15),videoRef:t.ref})});return r.a.createElement("div",{id:"camera_list"},function(e){if(e)return r.a.createElement("div",null,r.a.createElement("button",{id:"dummyBtn",onClick:B},"dummy reset"),r.a.createElement("button",{id:"startBtn",onClick:O},"start and pause all cams"),r.a.createElement("button",{id:"resumeBtn",onClick:P},"resume all cams"),r.a.createElement("button",{id:"stopBtn",onClick:j},"stop all cams"),r.a.createElement("button",{id:"addCamBtn",className:"hidden_button",onClick:w},"Add Cam"))}(!0),r.a.createElement("div",null,r.a.createElement("div",{className:"cameras"},t)))}()}n(104),n(105);var w=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).saveName=function(){var e=document.getElementById("name").value,t="?name="+e+"&sentence_index=0";window.history.pushState(null,null,t),n.props.socket.emit("client: start testing",{name:e,sentence_index:0}),n.props.socket.emit("client: dummy vid, do not save"),n.props.socket.emit("client: update recording progress",0),n.props.socket.emit("client: save total time",[0,0,0]),n.props.socket.emit("client: save total start time",new Date),n.props.updateTesterContents(),n.props.updateGreenLightStatus(!0)},n.detectEnter=function(e){13===e.which&&n.saveName(e)},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"name_input"},r.a.createElement("input",{type:"text",name:"name",id:"name",placeholder:"\u8f93\u5165\u540d\u5b57\uff08\u62fc\u97f3\uff09",onKeyPress:this.detectEnter,autoFocus:!0}),r.a.createElement("br",null),r.a.createElement("button",{className:"btn btn-center",onClick:this.saveName},"Save Name")))}}]),t}(a.Component);function B(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(!1),i=Object(S.a)(o,2),l=i[0],u=i[1],d=Object(a.useState)(!1),m=Object(S.a)(d,2),p=m[0],f=m[1],g=Object(a.useState)(h("name")),v=Object(S.a)(g,2),_=v[0],b=v[1];function E(t){f(!0),e.updateSentence(t)}function y(){return c?"Done":l&&!p?"Retry":"Record"}function k(){var t;u(!0),s(!1),e.socket.emit("client: stop cams","in process screen"),f(!1),e.showFileSavingLoader(),e.updateSentence("$next"),e.updateGreenLightStatus(!1),e.stopTimer(),(t=e.curr_sentence_index)>=0&&e.updateRecordProgress(t)}function C(){document.getElementById("showSavedFilesBtn").disabled=!1,c?k():(e.socket.emit("client: start cams","in process screen"),s(!0),e.startTimer(),document.getElementById("testerRecordBtn").className="btn btn-danger")}function N(){!function(){var t=e.recordedProgress>e.curr_sentence_index;try{document.getElementById("testerNextBtn").disabled=!t}catch(n){}}();var t=e.curr_sentence_index>0&&e.recordedProgress>=e.curr_sentence_index,n=t?"\u21ba":"",a=e.data[e.curr_sentence_index];if(a){var c=a.substring(0,10),s=a.substring(10);a=function(e,t){return r.a.createElement("div",{className:"emoji-layout-container"},r.a.createElement("div",{className:"emoji-layout-emoji-left"}," ",t),r.a.createElement("div",null,e[0],r.a.createElement("br",null),e[1]),r.a.createElement("div",{className:"emoji-layout-emoji-right"}," ",t))}([c,s],n)}var o=t?"recorded_sentence_highlight sentence_to_be_read":"sentence_to_be_read";return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("div",{className:o},a))}function x(){b(!0)}return r.a.createElement("div",{className:"test_container"},function(){if(_){try{var t=document.getElementById("record_time_content"),n=document.getElementById("record_time_msg");"gray"===("00:00:00"===t.innerText?"gray":"red")?(t.style.transition="all 0.5 ease",n.style.transition="all 0.5 ease",t.style.color="black",n.style.color="black"):(t.style.transition="all 0.5 ease",n.style.transition="all 0.5 ease",t.style.color="#FF1053",n.style.color="#FF1053")}catch(s){}return r.a.createElement("div",null,N(),r.a.createElement("div",{className:"recording_hint"},r.a.createElement("pre",{id:"record_time_content"},"00:00:00"),r.a.createElement("pre",{id:"record_time_msg"},"\u5f55\u5236\u4e2d")),r.a.createElement("button",{id:"testerRecordBtn",className:"Done"===y()?"btn btn-danger":"btn_highlight_green",onClick:C,disabled:!e.recordGreenLight||e.numFilesSaved%e.numCams!==0},"Done"===(a=y())?"\u7ed3\u675f\u5f55\u5236":"Retry"===a?"\u91cd\u65b0\u5f55\u5236":"Record"===a?"\u5f00\u59cb\u5f55\u5236":a),r.a.createElement("br",null),r.a.createElement("button",{className:"btn",id:"testerPrevBtn",onClick:function(){return E("$prev")},disabled:0===e.curr_sentence_index||!e.recordGreenLight||e.numFilesSaved%e.numCams!==0||c},"\u2b05\u4e0a\u4e00\u53e5"),r.a.createElement("button",{className:"btn",id:"testerNextBtn",onClick:function(){return E("$next")},disabled:e.curr_sentence_index===e.data_length-1||!e.recordGreenLight||e.numFilesSaved%e.numCams!==0||c},"\u4e0b\u4e00\u53e5\u27a1"))}return r.a.createElement("div",null,r.a.createElement(w,{socket:e.socket,updateTesterContents:x,updateGreenLightStatus:e.updateGreenLightStatus}));var a}())}function O(e){var t=Object(a.useState)(void 0),n=Object(S.a)(t,2),c=n[0],s=n[1];function o(){clearInterval(c),document.getElementById(e.name).innerHTML="00:00:00"}function i(t){var n=t||[0,0,0];try{n=n.map(function(e){return e||0})}catch(a){console.error("some issue with this: "+n)}return setInterval(function(){var t=n[0],a=n[1],r=n[2];r<60&&(r+=1),60===r&&(a+=1,r=0),60===a&&(t+=1,a=0),n=[t,a,r];try{document.getElementById(e.name).innerHTML=("0"+t).slice(-2)+":"+("0"+a).slice(-2)+":"+("0"+r).slice(-2)}catch(c){console.error(c)}e.updateTotalTime(n)},1e3)}return Object(a.useEffect)(function(){e.socket.emit("client: get total time"),e.socket.on("server: response for total time",function(e){e||c||s(i()),o(),s(i(e))}),e.socket.on("server: reset total timer",function(){o(),s(i())})},[]),r.a.createElement("div",null)}var j=n(61);function L(e){var t=(e.curr/e.total*100).toFixed(2),n="left"===e.align?{margin:"0"}:{};return r.a.createElement("div",{className:"progress_bar",style:n},r.a.createElement("pre",null,e.curr," / ",e.total," (",t,"%)"),r.a.createElement(j.a,{percent:t,strokeWidth:e.strokeWidth,trailWidth:e.strokeWidth,strokeColor:"#64e7fd",trailColor:"#363732"}))}var P=function(e){var t=Object(a.useState)(void 0),n=Object(S.a)(t,2),c=n[0],s=n[1];function o(){clearInterval(c),document.getElementById("record_time_content").innerHTML="00:00:00"}function i(){s(function(){var e=[0,0,0];return setInterval(function(){var t=e[0],n=e[1],a=e[2];a<60&&(a+=1),60===a&&(n+=1,a=0),60===n&&(t+=1,n=0),e=[t,n,a],document.getElementById("record_time_content").innerHTML=("0"+t).slice(-2)+":"+("0"+n).slice(-2)+":"+("0"+a).slice(-2)},10)}())}return r.a.createElement("div",{className:"testing_screen"},r.a.createElement(O,{name:"total_timer",socket:e.socket,totalTime:e.totalTime,updateTotalTime:e.updateTotalTime}),r.a.createElement("pre",{id:"total_timer"},"00:00:00"),r.a.createElement(L,{curr:e.recordedProgress,total:e.data_length-1,align:"center",strokeWidth:2}),r.a.createElement("div",{className:"middle"},r.a.createElement("div",{className:"inner"},r.a.createElement(B,{updateSentence:e.updateSentence,curr_sentence_index:e.curr_sentence_index,data_length:e.data_length,socket:e.socket,data:e.data,curr_sentence:e.curr_sentence,recordGreenLight:e.recordGreenLight,updateGreenLightStatus:e.updateGreenLightStatus,numFilesSaved:e.numFilesSaved,numCams:e.numCams,stopTimer:o,startTimer:i,recordedProgress:e.recordedProgress,updateRecordProgress:e.updateRecordProgress,showFileSavingLoader:e.showFileSavingLoader}))),r.a.createElement("pre",{hidden:e.recordGreenLight||0===e.curr_sentence_index||!h("name"),className:"warning_message"},"\u5982\u679c\u7b49\u4fdd\u5b58\u65f6\u95f4\u591a\u4f5910\u79d2\u949f\uff0c\u901a\u77e5\u8001\u5e08\u6765\u4ece\u8bbe\u7f6e\u673a\u5668"))},F=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("div",null,"Sentence")))}}]),t}(a.Component),T=(n(106),n(107),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).getClassOfRowItem=function(){return(n.props.read?"read row_item":"row_item")+(n.props.curr_sentence_index===n.props.index?" curr_sentence":"")},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"table_row"},r.a.createElement("div",{className:this.getClassOfRowItem()},this.props.index+": "+this.props.sentence)))}}]),t}(a.Component)),D=(n(108),function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updateDataOnPageChange=function(){},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.data,n=this.props.curr_page,a=this.props.max_per_page,c=n*a-a,s=c+a,o=t.slice(c,s).map(function(t,n){return r.a.createElement(T,{curr_sentence_index:e.props.curr_sentence_index,sentence:t,time:"00:00",read:!1,key:t+":"+n,index:n+c})});return r.a.createElement("div",{className:"table"},o)}}]),t}(a.Component)),M=(n(109),function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:this.props.selected?"page_num":"can_click_num page_num",onClick:function(){return e.props.updatePage(e.props.num)}},this.props.num)}}]),t}(a.Component)),R=n(52),A=n.n(R),G=n(53),W=n.n(G),H=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){n.props.updatePage(Number(e.target.value))},n.handleSubmit=function(e){e.preventDefault()},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",{htmlFor:"page"},"Page:"),r.a.createElement("input",{type:"text",value:this.props.curr_page,onChange:this.handleChange})))}}]),t}(a.Component),V=n(54),q=n.n(V),$=n(55),U=n.n($),J=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).updatePage=function(e){n.props.updatePage(e)},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this,t=this.props.curr_page,n=this.props.max_per_page,a=Math.floor(n/2),c=Number(((this.props.total_data+1)/this.props.max_per_page+1).toFixed(0)),s=Array.from(new Array(n),function(e,r){return t<=a?r:t>=c-a?r+c-n:r+t-a-1}).map(function(n){return n+=1,r.a.createElement(M,{num:n,selected:t===n,key:n,updatePage:e.props.updatePage})});return r.a.createElement("div",null,r.a.createElement("div",{className:"table_header_footer"},r.a.createElement("div",{className:"table_footer"},r.a.createElement("div",{className:"left_footer"},r.a.createElement(H,{updatePage:this.props.updatePage,curr_page:this.props.curr_page})),r.a.createElement("div",{className:"right_footer"},r.a.createElement("img",{src:q.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(1)}}),r.a.createElement("img",{src:W.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t-1)}}),s,r.a.createElement("img",{src:A.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(t+1)}}),r.a.createElement("img",{src:U.a,alt:"",className:"small_btn",onClick:function(){return e.props.updatePage(c)}})))))}}]),t}(a.Component),z=function(e){function t(e){var n;Object(u.a)(this,t);return(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={max_per_page:8},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(F,null),r.a.createElement(D,{data:this.props.data,curr_page:this.props.curr_page,max_per_page:this.state.max_per_page,curr_sentence_index:this.props.curr_sentence_index}),r.a.createElement(J,{total_data:this.props.data.length,updatePage:this.props.updatePage,curr_page:this.props.curr_page,max_per_page:this.state.max_per_page}))}}]),t}(a.Component),K=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"name_field"}),r.a.createElement("div",{className:"data_table"},r.a.createElement(z,{data:this.props.data,curr_sentence_index:this.props.curr_sentence_index,curr_page:this.props.curr_page,updatePage:this.props.updatePage})))}}]),t}(a.Component),Y=n(18),Q=n.n(Y);function X(e){var t=Object(Y.useModali)({animated:!0,title:e.title,message:e.message,buttons:[r.a.createElement(Q.a.Button,{label:e.buttonCancel?e.buttonCancel:"",isStyleCancel:!0,className:e.buttonCancel?"":"display_none",key:e.buttonCancel,hidden:!e.buttonCancel,onClick:function(){return s()}}),r.a.createElement(Q.a.Button,{label:e.buttonConfirm,isStyleDestructive:!0,onClick:function(){e.confirmFunc&&e.confirmFunc(),s(),e.toast&&_.a.info(e.toast)},hidden:!e.buttonConfirm,key:e.buttonConfirm})]}),n=Object(S.a)(t,2),c=n[0],s=n[1];return Object(a.useEffect)(function(){e.onLoadFunc&&e.onLoadFunc();try{e.buttonCancel||(document.getElementsByClassName("modali-button-cancel")[0].className+=" display_none"),e.buttonConfirm||(document.getElementsByClassName("modali-button-destructive")[0].className+=" display_none")}catch(t){}},[]),r.a.createElement("div",{style:{height:"0px"}},r.a.createElement("button",{className:"hidden_button",id:e.modalID,onClick:s},"toggle modal"),r.a.createElement(Q.a.Modal,c))}function Z(e){var t=Object(a.useState)(1/0),n=Object(S.a)(t,2),c=n[0],s=n[1],o=void 0,i=0;Object(a.useEffect)(function(){clearInterval(o),e.socket.on("server: response for start time",function(e){try{e=new Date(e);var t=m(e),n=m(new Date)-t,a=Math.floor(n/3600);n-=3600*a;var r=Math.floor(n/60),c=[a,r,n-=60*r];l(c),o=setInterval(function(){return d(c)},1e3)}catch(s){console.error(s)}}),p(),s(0),console.log(c)},[]);var l=function(e){try{document.getElementById("total_time_elapsed").innerText="Total Recording Time\u2014"+("0"+e[0]).slice(-2)+":"+("0"+e[1]).slice(-2)+":"+("0"+e[2]).slice(-2)}catch(t){}},u=void 0,d=function(e){u||(u=e);var t=u[0],n=u[1],a=u[2];a<60&&(a+=1),60===a&&(n+=1,a=0),60===n&&(t+=1,n=0),u=[t,n,a];try{l(u)}catch(r){console.error(r)}},m=function(e){return 60*e.getHours()*60+60*e.getMinutes()+e.getSeconds()},p=function(){try{document.getElementById("showTimeBtn").click(),document.getElementById("showTimeBtn").disabled=!0}catch(e){}};return r.a.createElement("div",null,r.a.createElement(L,{curr:e.recordedProgress,total:e.data_length-1,align:"left",strokeWidth:3}),r.a.createElement("pre",{id:"total_time_elapsed"},"00:00:00"),r.a.createElement("pre",{id:"total_words"}," / ",e.totalWords),r.a.createElement("pre",{id:"connection_status"}),r.a.createElement("pre",{id:"num_files_saved"}),i++,r.a.createElement("pre",{hidden:e.recordGreenLight||e.helper_checkIfMobileView()||!h("name"),className:"warning_message"},"Please Click Reset!"),r.a.createElement("button",{onClick:function(){e.socket.emit("client: ask for start time")},id:"showTimeBtn",className:"hidden_button"}))}n(121);function ee(e){return Object(a.useEffect)(function(){var t=document.getElementById(e.id);try{t.addEventListener("change",function(){e.onChangeFunc(t.checked)})}catch(n){}},[]),r.a.createElement("div",{className:"switch-wrapper"},r.a.createElement("div",{className:"switch"},r.a.createElement("div",{className:"invisible_pushdown"}),r.a.createElement("input",{type:"checkbox",name:"toggle",id:e.id}),r.a.createElement("label",{htmlFor:"toggle",className:"inset-toggle"},r.a.createElement("i",null,"\ud83d\udd77"))))}n(122);function te(){return r.a.createElement("div",{className:"checkmark"},r.a.createElement("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 161.2 161.2",enableBackground:"new 0 0 161.2 161.2",xmlSpace:"preserve"},r.a.createElement("path",{className:"path",fill:"none",stroke:"#FFBA49",strokeMiterlimit:"10",d:"M425.9,52.1L425.9,52.1c-2.2-2.6-6-2.6-8.3-0.1l-42.7,46.2l-14.3-16.4 c-2.3-2.7-6.2-2.7-8.6-0.1c-1.9,2.1-2,5.6-0.1,7.7l17.6,20.3c0.2,0.3,0.4,0.6,0.6,0.9c1.8,2,4.4,2.5,6.6,1.4c0.7-0.3,1.4-0.8,2-1.5 c0.3-0.3,0.5-0.6,0.7-0.9l46.3-50.1C427.7,57.5,427.7,54.2,425.9,52.1z"}),r.a.createElement("circle",{className:"path",fill:"none",stroke:"#FFBA49",strokeWidth:"4",strokeMiterlimit:"10",cx:"80.6",cy:"80.6",r:"62.1"}),r.a.createElement("polyline",{className:"path",fill:"none",stroke:"#FFBA49",strokeWidth:"6",strokeLinecap:"round",strokeMiterlimit:"10",points:"113,52.8  74.1,108.4 48.2,86.4 "}),r.a.createElement("circle",{className:"spin",fill:"none",stroke:"#FFBA49",strokeWidth:"4",strokeMiterlimit:"10",strokeDasharray:"12.2175,12.2175",cx:"80.6",cy:"80.6",r:"73.9"})),r.a.createElement("p",{id:"complete_message"},"\ud83d\udd25 \u606d\u559c\u60a8\u5b8c\u6210 \ud83d\udd25"))}n(123);function ne(){return r.a.createElement("div",{className:"pyro"},r.a.createElement("div",{className:"before"}),r.a.createElement("div",{className:"after"}))}n(124);function ae(){return r.a.createElement("div",{className:"CompleteAnimationBG"},r.a.createElement(ne,null),r.a.createElement(te,null))}var re=n(56),ce=n.n(re),se=n(57),oe=n.n(se),ie=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).per_page=8,n.curr_index=h("sentence_index"),n.ip_address="http://192.168.0.103:5000",n.main_userView=function(){return r.a.createElement("div",{className:"container"},n.comp_debug(),n.comp_tester(),n.comp_userResearchHeader(),r.a.createElement("div",{className:"contents"},r.a.createElement("div",{className:"left_panel"},n.comp_dataCollection()),r.a.createElement("div",{className:"right_panel cameras_container"},n.comp_cameraList()),r.a.createElement("div",{className:""})))},n.main_adminView=function(){return r.a.createElement("div",{style:{textAlign:"center"}},n.comp_debug())},n.main_playground=function(){return r.a.createElement(ee,null)},n.comp_completeAnimation=function(){if(n.state.recordedProgress+1===n.state.data.length){try{document.getElementById("testerNextBtn").disabled=!0}catch(e){}return r.a.createElement(ae,null)}},n.comp_dataCollection=function(){return r.a.createElement(K,{data:n.state.data,updateName:n.updateName,curr_sentence:n.state.curr_sentence,socket:n.state.socket,curr_sentence_index:n.state.curr_sentence_index,curr_page:n.state.curr_page,updatePage:n.updatePage})},n.comp_tester=function(){return r.a.createElement(P,{updateSentence:n.updateSentence,data:n.state.data,curr_sentence_index:n.state.curr_sentence_index,data_length:n.state.data.length,first_sentence:n.state.data[n.state.curr_sentence_index],curr_sentence:n.state.curr_sentence,socket:n.state.socket,recordGreenLight:n.state.recordGreenLight&&n.state.numFilesSavedTotal%n.state.requiredNumCams===0,numFilesSaved:n.state.numFilesSavedTotal,numCams:n.state.requiredNumCams,updateGreenLightStatus:n.updateGreenLightStatus,recordedProgress:n.state.recordedProgress,updateRecordProgress:n.updateRecordProgress,totalTime:n.state.totalTime,updateTotalTime:n.updateTotalTime,showFileSavingLoader:n.disp_showFileSavingLoader})},n.comp_userResearchHeader=function(){return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h1",null,"For User Researcher Purpose Only"),r.a.createElement("hr",null))},n.comp_cameraList=function(){return r.a.createElement(I,{socket:n.state.socket,computerID:n.state.computerID,computerStatus:n.state.computerStatus,updateConnectionStatus:n.updateConnectionStatus,addCamState:n.state.addCamState,toggleCamState:n.helper_toggleCamState,updateDetectedNumCams:n.updateDetectedNumCams})},n.comp_status=function(){return r.a.createElement(Z,{totalWords:n.state.totalWords,data_length:n.state.data.length,recordedProgress:n.state.recordedProgress,helper_checkIfMobileView:n.helper_checkIfMobileView,recordGreenLight:n.state.recordGreenLight,socket:n.state.socket})},n.comp_modals=function(){return r.a.createElement("div",null,r.a.createElement(X,{modalID:"resetProgressModal",socket:n.state.socket,title:"Are you sure?",message:"Resetting progress will be permanent.",buttonCancel:"Cancel",buttonConfirm:"Reset Progress",buttonConfirmId:"resetProgressBtn",toast:"Progress reset",confirmFunc:n.admin_resetProgress}),r.a.createElement(X,{modalID:"overallStatus",socket:n.state.socket,title:"Status",onLoadFunc:n.getStatus,message:n.comp_status(),buttonConfirm:"Hide"}))},n.comp_debug=function(){return r.a.createElement("div",{className:"debug-group"},r.a.createElement("button",{onClick:function(){n.helper_toggleModal("overallStatus"),n.getStatus()},className:"debug_button"},"Status"),r.a.createElement("button",{id:"resetCamsBtn",className:"debug_button",onClick:n.admin_resetCams},"Reset Cams"),r.a.createElement("button",{className:"debug_button",onClick:function(){n.helper_toggleModal("resetProgressModal")}},"Reset Progress"),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{className:"debug_label"},"Debug Mode: "),r.a.createElement(ee,{id:"debug_mode",onChangeFunc:n.handler_debugToggle})),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{htmlFor:"",className:"debug_label"},"Server: "),r.a.createElement("span",{className:"server_status"}),r.a.createElement("input",{id:"inputServerIP",type:"text",className:"debug_text_input",value:n.state.ip,onChange:n.handler_IPOnChange})),r.a.createElement("button",{className:"debug_button",onClick:n.handler_useThisCompAsServer()},"\ud83d\udda5"),r.a.createElement("div",{className:"debug_inline_group"},r.a.createElement("label",{htmlFor:"",className:"debug_label"},"Cams: "),r.a.createElement("input",{type:"text",className:"debug_text_input debug_sm_input",value:n.state.detectedNumCams,readOnly:!0})),r.a.createElement("button",{onClick:n.disp_showFileSavedMessage,id:"showSavedFilesBtn",className:"hidden_button"}))},n.updateFilesSaved=function(e){var t=e%n.state.requiredNumCams===0?" (successful)":" (not all cams saved!!)";n.setState({numFilesSavedTotal:e});try{document.getElementById("num_files_saved").innerHTML="Total Files Saved: "+e+t}catch(a){}},n.handler_useThisCompAsServer=function(){},n.handler_IPOnChange=function(e){n.setState({ip:e.target.value})},n.handler_debugToggle=function(e){n.setState({debugMode:e},function(){e?n.setState({requiredNumCams:1}):n.setState({requiredNumCams:8})})},n.handler_fileSaveSuccess=function(e){n.updateFilesSaved(e),n.setState({numFilesSavedInd:n.state.numFilesSavedInd+1},function(){console.log("this occured: "+n.state.numFilesSavedInd+" times.");try{document.getElementById("testerNextBtn").disabled=!0}catch(e){}if(n.state.numFilesSavedInd===n.state.requiredNumCams){console.log("correct number of files saved");try{document.getElementById("showSavedFilesBtn").click(),document.getElementById("showSavedFilesBtn").disabled=!0,n.setState({numFilesSavedInd:0},function(){_.a.success(n.style_makeEmojiToastLayout(["\u89c6\u9891\u5df2\u6210\u529f\u4fdd\u5b58","\u53ef\u7ee7\u7eed\u5f55"],"\ud83d\udd25"),{hideAfter:2})}),n.updateGreenLightStatus(!0)}catch(t){console.error(t)}try{n.helper_checkIfMobileView()&&_.a.info("Completed @ Sentence ["+n.state.recordedProgress+"]",{hideAfter:.75})}catch(e){console.error(e)}}})},n.updateDetectedNumCams=function(e){n.setState({detectedNumCams:e});try{document.getElementsByClassName("debug_sm_input")[0].className+=n.state.detectedNumCams>0?" serverPlaceholderConnected":""}catch(t){}},n.updateCompID=function(e){var t={};n.setState({computerID:e}),t[n.state.computerID]=[],n.setState({computerStatus:t},function(){})},n.style_addThisCpuIcon=function(e,t){var n=new RegExp(t,"g");return e.replace(n,"\ud83d\udda5: "+t)},n.style_makeEmojiToastLayout=function(e,t){return r.a.createElement("div",{className:"cogo-toast"},r.a.createElement("div",{className:"cogo-toast-emoji-left"}," ",t),r.a.createElement("div",null,e[0],r.a.createElement("br",null),e[1]),r.a.createElement("div",{className:"cogo-toast-emoji-right"}," ",t))},n.ref_hideLoader=void 0,n.disp_showFileSavingLoader=function(){n.ref_hideLoader=_.a.loading(n.style_makeEmojiToastLayout(["\u89c6\u9891\u6b63\u5728\u4fdd\u5b58","\u8bf7\u8010\u5fc3\u7b49\u5f85"],"\u231b\ufe0f"))},n.disp_showFileSavedMessage=function(){try{n.ref_hideLoader()}catch(e){}},n.initSocketListeners=function(){n.state.socket.on("server: online",function(){console.log("server online!"),document.getElementsByClassName("server_status")[0].classList.add("server_online"),document.getElementById("inputServerIP").classList.add("serverPlaceholderConnected")}),n.state.socket.on("server: disconnected",function(){n.setState({connectedToServer:!1},function(){document.getElementsByClassName("server_status")[0].classList.remove("server_online"),document.getElementById("inputServerIP").classList.remove("serverPlaceholderConnected")})}),n.state.socket.on("server: connected",function(e){console.log("detected server connected"),n.setState({connectedToServer:!0,computerID:e},function(){document.getElementsByClassName("server_status")[0].classList.add("server_online"),document.getElementById("inputServerIP").classList.add("serverPlaceholderConnected")})}),n.state.socket.on("server: connected sync id",function(e){n.updateCompID&&n.updateCompID(e),n.updateCompID=null}),n.state.socket.on("server: reset cams",function(){n.updateGreenLightStatus(!0)}),n.state.socket.on("server: response for connection status",function(e){try{document.getElementById("connection_status").innerHTML=n.style_addThisCpuIcon(JSON.stringify(e,null,2),n.state.computerID)}catch(t){}}),n.state.socket.on("server: response for progress",function(e){n.setState({recordedProgress:e||0})}),n.state.socket.on("server: response for numFilesSaved",function(e){n.updateFilesSaved(e)}),n.state.socket.on("server: save files successful",function(e){n.handler_fileSaveSuccess(e)}),n.state.socket.on("server: computer connected order",function(e){n.setState({connectedOrderMap:v()(n.state.connectedOrderMap,{$merge:e})})});var e=[0,666,1332];n.state.socket.on("server: refresh all",function(){var t=n.state.connectedOrderMap[n.state.computerID];setTimeout(function(){window.location.reload(!1)},e[t%3])})},n.updateSentence=function(e){"$next"===e?n.setState({curr_sentence_index:n.state.curr_sentence_index+1},function(){n.updateSentence(n.state.data[n.state.curr_sentence_index]),n.state.socket.emit("client: update sentence_index",{name:h("name"),curr_sentence_index:n.state.curr_sentence_index})}):"$prev"===e?n.setState({curr_sentence_index:Math.max(n.state.curr_sentence_index-1,0)},function(){n.updateSentence(n.state.data[n.state.curr_sentence_index]),n.state.socket.emit("client: update sentence_index",{name:h("name"),curr_sentence_index:n.state.curr_sentence_index})}):(window.history.pushState(null,null,"?name="+h("name")+"&sentence_index="+n.state.curr_sentence_index),n.setState({curr_sentence:e,curr_page:Math.floor(Number(n.state.curr_sentence_index)/n.state.per_page)+1}))},n.updatePage=function(e){console.log("update page",e),n.setState({curr_page:e>=1?e:1})},n.updateRecordProgress=function(e){n.setState({recordedProgress:e},function(){n.state.socket.emit("client: update recording progress",e)})},n.updateConnectionStatus=function(e){if(n.state.computerStatus[n.state.computerID]){var t={};t[n.state.computerID]=e,n.setState({computerStatus:t},function(){}),n.state.socket.emit("client: update recording status",t)}n.getStatus()},n.updateGreenLightStatus=function(e){n.setState({recordGreenLight:e})},n.updateTotalTime=function(e){n.setState({totalTime:e})},n.getStatus=function(){n.state.socket.emit("client: ping for connection status"),n.state.socket.emit("client: ping for numFilesSaved"),n.state.socket.emit("client: ping for progress")},n.admin_resetCams=function(){n.updateGreenLightStatus(!0),n.state.socket.emit("client: reset cams");try{document.getElementById("addCamBtn").click()}catch(e){}n.state.socket.emit("client: dummy vid, do not save"),document.getElementById("resetCamsBtn").className.includes("btn-active")||(document.getElementById("resetCamsBtn").className+=" btn-active")},n.admin_refreshAll=function(){n.state.socket.emit("client: refresh all")},n.admin_resetProgress=function(){n.state.socket.emit("client: update recording progress",0),n.state.socket.emit("client: delete total time"),n.state.socket.emit("client: reset total files"),n.state.socket.emit("client: save total start time",new Date),window.location=window.location.origin,n.state.socket.emit("client: save total time",[0,0,0])},n.helper_emitInitialSocketMessages=function(){n.helper_checkIfMobileView?n.state.socket.emit("client: ask for recording status"):n.state.socket.emit("client: update sentence_index",{name:h("name"),curr_sentence_index:n.state.curr_sentence_index}),n.state.socket.emit("client: check for progress"),n.state.socket.emit("client: ask for sync id")},n.helper_toggleModal=function(e){document.getElementById(e).click()},n.helper_checkIfMobileView=function(){return window.location.href.includes("mobile")},n.helper_toggleCamState=function(){n.setState({addCamState:!n.state.addCamState})},n.handler_keydown=function(e){var t=e.key;if([" ","ArrowLeft","ArrowRight","Escape","Enter","s"].includes(t))try{if(" "===t)document.getElementById("testerRecordBtn").click(),e.preventDefault();else if("ArrowLeft"===t)document.getElementById("testerPrevBtn").click(),e.preventDefault();else if("ArrowRight"===t)console.log("detected right arrow key"),document.getElementById("testerNextBtn").click(),e.preventDefault();else if("Escape"===t)document.getElementById("resetCamsBtn").click(),e.preventDefault();else if("Enter"===t){console.log("detected enter key"),document.getElementsByClassName("modali-button-destructive")[0]&&(document.getElementsByClassName("modali-button-destructive")[0].click(),n.admin_resetProgress());var a=document.getElementById("inputServerIP");document.activeElement===a&&(n.state.socket.disconnect(),document.getElementsByClassName("server_status")[0].classList.remove("server_online"),document.getElementById("inputServerIP").classList.remove("serverPlaceholderConnected"),console.log(a.value),n.setState({socket:k()(a.value),ip:a.value}),n.state.socket.emit("client: check server connection"),e.preventDefault())}else"s"===t&&document.activeElement!==document.getElementById("name")&&n.helper_toggleModal("overallStatus")}catch(r){console.error(r)}},n.state={requiredNumCams:8,curr_sentence:"",curr_sentence_index:n.curr_index?Number(n.curr_index):0,data:[],per_page:n.per_page,curr_page:n.curr_index?Math.floor(Number(n.curr_index)/n.per_page)+1:1,computerStatus:{},recordGreenLight:!1,computerID:-1,numFilesSavedTotal:0,numFilesSavedInd:0,connectedOrderMap:{},recordedProgress:0,addCamState:!1,totalTime:[],startTime:void 0,totalWords:0,remainingWords:0,debugMode:!1,socket:k()(n.ip_address),ip:n.ip_address,connectedToServer:!1,detectedNumCams:0},n}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement(b.a,null,r.a.createElement(E.a,{path:"/",exact:!0,component:this.main_userView}),r.a.createElement(E.a,{path:"/admin",exact:!0,component:this.main_adminView}),r.a.createElement(E.a,{path:"/playground",exact:!0,component:this.main_playground}),this.comp_modals(),this.comp_completeAnimation())}},{key:"componentDidMount",value:function(){console.log(oe.a),this.helper_emitInitialSocketMessages(),this.readTextFile(ce.a),this.initSocketListeners();try{document.getElementById("debug_mode").checked=1===this.state.requiredNumCams}catch(e){}window.addEventListener("keydown",this.handler_keydown),window.addEventListener("keyup",this.handler_keyup)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handler_keydown)}},{key:"readTextFile",value:function(e){var t=this;return fetch(e).then(function(e){return e.text()}).then(function(e){t.setState({data:e.split("\n")},function(){var e=h("sentence_index")?t.state.data[Number(h("sentence_index"))]:t.state.data[0];t.setState({curr_sentence:e},function(){}),t.setState({totalWords:t.state.data.reduce(function(e,t){return e+t.length},0)})})})}},{key:"pingServer",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.state.socket.io.opts.hostname,e.next=4,fetch(t,{mode:"no-cors"});case 4:e.sent.ok?console.log("connection successful"):console.error("no response from server"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(){return e.apply(this,arguments)}}()},{key:"handler_keyup",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,r=document.getElementsByClassName("debug_button")[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){a.value.classList.remove("btn-active")}}catch(c){t=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}}]),t}(r.a.Component);s.a.render(r.a.createElement(ie,null),document.getElementById("root"))},52:function(e,t,n){e.exports=n.p+"static/media/collapse-chevron.126ea5d6.svg"},53:function(e,t,n){e.exports=n.p+"static/media/expand-chevron.fd7409a7.svg"},54:function(e,t,n){e.exports=n.p+"static/media/beg.565428a5.svg"},55:function(e,t,n){e.exports=n.p+"static/media/end.b927e101.svg"},56:function(e,t,n){e.exports=n.p+"static/media/sentences.16736696.txt"},57:function(e,t,n){var a=n(125).networkInterfaces();e.exports={getIP:function(){console.log("getting ip...");var e=void 0;return Object.keys(a).forEach(function(t){a[t].forEach(function(n){"IPv4"===n.family&&!1===n.internal&&"en0"===t&&(e=n.address)})}),e}}},62:function(e,t,n){e.exports=n(128)},67:function(e,t,n){},99:function(e,t){}},[[62,1,2]]]);
//# sourceMappingURL=main.4a707ef7.chunk.js.map